---
- name: Gather transfers
  warkdev.axway_cft.axway_cft_transfers_info:
  register: cft_transfers

- name: Validate received transfers
  vars:
    expected_transfer:
      partner: "PARIS"
      direct: "send"
      type: "file"
      compatstate: "state"
      ack: "ack"
      state: "state"
      phase: "T"
      phasestep: "E"
      idf: "ABCD"
      idt: "A0112102"
      idtu: "A000004K"
      pidtu: "A000004K"
      nrec: "25"
      frec: "52"
      msg: "My tailor is rich"
      diagi: "0"
      diagp: ""
      requser: "cft_user"
      reqgroup: "cft_group"
      ida: "2596373"
  assert:
    that:
    - cft_transfers.transfers is defined
    - (cft_transfers.transfers | length) == 2
    - cft_transfers.transfers[0].partner == expected_transfer.partner
    - cft_transfers.transfers[0].direct == expected_transfer.direct
    - cft_transfers.transfers[0].type == expected_transfer.type
    - cft_transfers.transfers[0].compatstate == expected_transfer.compatstate
    - cft_transfers.transfers[0].ack == expected_transfer.ack
    - cft_transfers.transfers[0].state == expected_transfer.state
    - cft_transfers.transfers[0].phase == expected_transfer.phase
    - cft_transfers.transfers[0].phasestep == expected_transfer.phasestep
    - cft_transfers.transfers[0].idf == expected_transfer.idf
    - cft_transfers.transfers[0].idt == expected_transfer.idt
    - cft_transfers.transfers[0].idtu == expected_transfer.idtu
    - cft_transfers.transfers[0].pidtu == expected_transfer.pidtu
    - cft_transfers.transfers[0].nrec == expected_transfer.nrec
    - cft_transfers.transfers[0].frec == expected_transfer.frec
    - cft_transfers.transfers[0].msg == expected_transfer.msg
    - cft_transfers.transfers[0].diagi == expected_transfer.diagi
    - cft_transfers.transfers[0].diagp == expected_transfer.diagp
    - cft_transfers.transfers[0].requser == expected_transfer.requser
    - cft_transfers.transfers[0].reqgroup == expected_transfer.reqgroup
    - cft_transfers.transfers[0].ida == expected_transfer.ida