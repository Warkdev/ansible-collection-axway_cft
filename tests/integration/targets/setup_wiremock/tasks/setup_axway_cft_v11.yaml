---
- name: Pull default Wiremock image
  community.docker.docker_image:
    name: "{{ setup_wiremock_docker_image }}"
    source: pull

- name: Create Wiremock container
  community.docker.docker_container:
    name: axway_cft_api_v11
    image: "{{ setup_wiremock_docker_image }}"
    ports:
    - "8443:8443"
    volumes:
    - "{{ role_path }}/files/axway_cft_v11:/home/wiremock"
    command: "--disable-http --https-port 8443"
    state: started

- name: Pause for a couple of seconds before check
  pause:
    seconds: 1

- name: Wait for Wiremock service to be up
  wait_for:
    host: localhost
    port: 8443